<div class="mb-6">
  <div class="sm:flex sm:items-center sm:justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-gray-900"><%= @group.name %></h1>
      <% if @group.description.present? %>
        <p class="mt-1 text-sm text-gray-500"><%= @group.description %></p>
      <% end %>
    </div>
    <div class="mt-4 sm:mt-0 flex gap-3">
      <%= link_to "Edit", edit_admin_group_path(@group), class: "rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" %>
      <%= button_to "Delete", admin_group_path(@group), method: :delete, data: { turbo_confirm: "Are you sure?" }, class: "rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500" %>
    </div>
  </div>
</div>

<div class="space-y-6">
  <!-- Members -->
  <div class="bg-white shadow sm:rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <h3 class="text-base font-semibold leading-6 text-gray-900 mb-4">
        Members (<%= @members.count %>)
      </h3>
      <% if @members.any? %>
        <ul class="divide-y divide-gray-200 border border-gray-200 rounded-md">
          <% @members.each do |user| %>
            <li class="px-4 py-3 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-gray-900"><%= user.email_address %></p>
                <div class="flex gap-2 mt-1">
                  <% if user.admin? %>
                    <span class="inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700">Admin</span>
                  <% end %>
                  <% if user.totp_enabled? %>
                    <span class="inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-700">2FA</span>
                  <% end %>
                  <span class="inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-700"><%= user.status.titleize %></span>
                </div>
              </div>
              <%= link_to "View", admin_user_path(user), class: "text-blue-600 hover:text-blue-900 text-sm" %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="rounded-md bg-gray-50 p-4">
          <p class="text-sm text-gray-500">No members in this group yet.</p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Applications -->
  <div class="bg-white shadow sm:rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <h3 class="text-base font-semibold leading-6 text-gray-900 mb-4">
        Assigned Applications (<%= @applications.count %>)
      </h3>
      <% if @applications.any? %>
        <ul class="divide-y divide-gray-200 border border-gray-200 rounded-md">
          <% @applications.each do |app| %>
            <li class="px-4 py-3 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-gray-900"><%= app.name %></p>
                <div class="flex gap-2 mt-1">
                  <% case app.app_type %>
                  <% when "oidc" %>
                    <span class="inline-flex items-center rounded-full bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-700">OIDC</span>
                  <% when "trusted_header" %>
                    <span class="inline-flex items-center rounded-full bg-indigo-100 px-2 py-0.5 text-xs font-medium text-indigo-700">ForwardAuth</span>
                  <% end %>
                  <% if app.active? %>
                    <span class="inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-700">Active</span>
                  <% else %>
                    <span class="inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-700">Inactive</span>
                  <% end %>
                </div>
              </div>
              <%= link_to "View", admin_application_path(app), class: "text-blue-600 hover:text-blue-900 text-sm" %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="rounded-md bg-gray-50 p-4">
          <p class="text-sm text-gray-500">This group is not assigned to any applications.</p>
        </div>
      <% end %>
    </div>
  </div>
</div>
